// --- PREGUNTAS ---
const preguntas = [
  {
  texto: "En quin any es va fundar el Club de Roma?",
  opciones: [
    "a) 1960",
    "b) 1968",
    "c) 1973",
    "d) 1987"
  ],
  correcta: "b"
},
{
  texto: "Quin informe va publicar el Club de Roma?",
  opciones: [
    "a) Informe Brundtland",
    "b) Informe Meadows",
    "c) Agenda 21",
    "d) Protocol de Kyoto"
  ],
  correcta: "b"
},
{
  texto: "Quin any es va celebrar el primer Dia de la Terra?",
  opciones: [
    "a) 1965",
    "b) 1970",
    "c) 1980",
    "d) 1992"
  ],
  correcta: "b"
},
{
  texto: "Quina agÃ¨ncia es va crear arran del primer Dia de la Terra?",
  opciones: [
    "a) FAO",
    "b) ONU",
    "c) EPA",
    "d) UE"
  ],
  correcta: "c"
},
{
  texto: "Quin any es va aprovar el Primer Programa dâ€™AcciÃ³ ComunitÃ ria sobre el Medi Ambient?",
  opciones: [
    "a) 1968",
    "b) 1973",
    "c) 1980",
    "d) 1992"
  ],
  correcta: "b"
},
{
  texto: "Quin informe defineix per primera vegada el concepte de desenvolupament sostenible?",
  opciones: [
    "a) Informe Meadows",
    "b) Informe Brundtland",
    "c) Agenda 21",
    "d) Protocol de Kyoto"
  ],
  correcta: "b"
},
{
  texto: "On es va celebrar la ConferÃ¨ncia de les Nacions Unides sobre Medi Ambient i Desenvolupament de 1992?",
  opciones: [
    "a) Kyoto",
    "b) ParÃ­s",
    "c) Mont-real",
    "d) Rio de Janeiro"
  ],
  correcta: "d"
},
{
  texto: "Quin lema sâ€™associa a lâ€™Agenda 21?",
  opciones: [
    "a) Pensa global, actua local",
    "b) Salvem el planeta",
    "c) Creixement verd",
    "d) Futur sostenible"
  ],
  correcta: "a"
},
{
  texto: "Quin reglament europeu sobre medi ambient es va crear el 1995?",
  opciones: [
    "a) EMAS",
    "b) ISO 14000",
    "c) REACH",
    "d) Ecolabel"
  ],
  correcta: "a"
},
{
  texto: "Quan es van publicar les normes ISO 14000?",
  opciones: [
    "a) 1987",
    "b) 1996",
    "c) 2005",
    "d) 2015"
  ],
  correcta: "b"
},
{
  texto: "Quin Ã©s lâ€™objectiu principal del Protocol de Kyoto?",
  opciones: [
    "a) Reduir les emissions de gasos dâ€™efecte hivernacle",
    "b) Eliminar els CFC",
    "c) Fomentar el reciclatge mundial",
    "d) Restaurar la capa dâ€™ozÃ³"
  ],
  correcta: "a"
},
{
  texto: "Quin paÃ­s va permetre que el Protocol de Kyoto entrÃ©s en vigor?",
  opciones: [
    "a) Estats Units",
    "b) RÃºssia",
    "c) Xina",
    "d) Espanya"
  ],
  correcta: "b"
},
{
  texto: "En quin any va entrar en vigor el Protocol de Kyoto?",
  opciones: [
    "a) 1997",
    "b) 2000",
    "c) 2005",
    "d) 2012"
  ],
  correcta: "c"
},
{
  texto: "A quin percentatge de reducciÃ³ global dâ€™emissions aspirava el Protocol de Kyoto?",
  opciones: [
    "a) 2%",
    "b) 5%",
    "c) 8%",
    "d) 10%"
  ],
  correcta: "b"
},
{
  texto: "Quin any es va celebrar la Cimera Mundial sobre Desenvolupament Sostenible?",
  opciones: [
    "a) 2000",
    "b) 2002",
    "c) 2005",
    "d) 2015"
  ],
  correcta: "b"
},
{
  texto: "Quin acord internacional es va proposar el 2015 per limitar lâ€™augment de temperatura global?",
  opciones: [
    "a) Acord de ParÃ­s",
    "b) Agenda 21",
    "c) Protocol de Montreal",
    "d) ConferÃ¨ncia de Kyoto"
  ],
  correcta: "a"
},
{
  texto: "Quin Ã©s lâ€™objectiu principal de lâ€™Acord de ParÃ­s?",
  opciones: [
    "a) Limitar lâ€™augment de temperatura global per sota dels 2ÂºC",
    "b) Eliminar els residus plÃ stics",
    "c) Reduir la contaminaciÃ³ de lâ€™aigua",
    "d) Fomentar lâ€™economia circular"
  ],
  correcta: "a"
},
{
  texto: "Quin fenomen Ã©s causat per compostos que contenen clor i brom com els CFC?",
  opciones: [
    "a) Escalfament global",
    "b) Deteriorament de la capa dâ€™ozÃ³",
    "c) EutrofitzaciÃ³",
    "d) AcidificaciÃ³"
  ],
  correcta: "b"
},
{
  texto: "En quin protocol es van prohibir els CFC?",
  opciones: [
    "a) Montreal",
    "b) Kyoto",
    "c) ParÃ­s",
    "d) Rio"
  ],
  correcta: "a"
},
{
  texto: "Quina Ã©s una conseqÃ¼Ã¨ncia del deteriorament de la capa dâ€™ozÃ³?",
  opciones: [
    "a) CÃ ncer de pell i cataractes",
    "b) ReducciÃ³ del COâ‚‚ atmosfÃ¨ric",
    "c) DisminuciÃ³ de radiaciÃ³ ultraviolada",
    "d) Augment de la pluja Ã cida"
  ],
  correcta: "a"
},
{
  texto: "QuÃ¨ Ã©s lâ€™escalfament global?",
  opciones: [
    "a) Un procÃ©s natural de refredament del planeta",
    "b) Lâ€™augment gradual de la temperatura de la Terra causat per lâ€™activitat humana",
    "c) Una disminuciÃ³ de la radiaciÃ³ solar que arriba a la Terra",
    "d) Lâ€™augment de lâ€™albedo terrestre"
  ],
  correcta: "b"
},
{
  texto: "Quin gas contribueix principalment a lâ€™efecte hivernacle?",
  opciones: [
    "a) Oâ‚‚",
    "b) Nâ‚‚",
    "c) COâ‚‚",
    "d) Hâ‚‚"
  ],
  correcta: "c"
},
{
  texto: "Quina Ã©s una conseqÃ¼Ã¨ncia directa de lâ€™escalfament global?",
  opciones: [
    "a) Descens del nivell del mar",
    "b) Increment de fenÃ²mens meteorolÃ²gics extrems",
    "c) Augment de la capa dâ€™ozÃ³",
    "d) DisminuciÃ³ de la temperatura mitjana global"
  ],
  correcta: "b"
},
{
  texto: "QuÃ¨ causa lâ€™acidificaciÃ³ del medi?",
  opciones: [
    "a) Emissions de CFC",
    "b) Emissions de SOâ‚‚ i NOx",
    "c) Emissions de metÃ ",
    "d) Escalfament global"
  ],
  correcta: "b"
},
{
  texto: "Quina caracterÃ­stica tÃ© la pluja Ã cida?",
  opciones: [
    "a) TÃ© un pH alt (bÃ sic)",
    "b) TÃ© un pH baix (Ã cid)",
    "c) TÃ© un pH neutre (7)",
    "d) No afecta el medi natural"
  ],
  correcta: "b"
},
{
  texto: "QuÃ¨ Ã©s lâ€™eutrofitzaciÃ³?",
  opciones: [
    "a) AcumulaciÃ³ de nutrients en ecosistemes aquÃ tics",
    "b) ReducciÃ³ del nivell de nutrients al sÃ²l",
    "c) GeneraciÃ³ de smog urbÃ ",
    "d) ErosiÃ³ del terreny"
  ],
  correcta: "a"
},
{
  texto: "Quina Ã©s una conseqÃ¼Ã¨ncia de lâ€™eutrofitzaciÃ³?",
  opciones: [
    "a) Augment de la biodiversitat",
    "b) Olor desagradable i pÃ¨rdua de vida aquÃ tica",
    "c) ReducciÃ³ de la pluja Ã cida",
    "d) DisminuciÃ³ de la temperatura de lâ€™aigua"
  ],
  correcta: "b"
},
{
  texto: "Com sâ€™anomena la boira contaminant formada per Ã²xids i partÃ­cules?",
  opciones: [
    "a) Smog",
    "b) EutrofitzaciÃ³",
    "c) Pluja Ã cida",
    "d) OzÃ³ troposfÃ¨ric"
  ],
  correcta: "a"
},
{
  texto: "Quins efectes provoca lâ€™smog en la salut humana?",
  opciones: [
    "a) IrritaciÃ³ ocular i respiratÃ²ria",
    "b) HipotÃ¨rmia",
    "c) Augment de la pressiÃ³ arterial",
    "d) PÃ¨rdua dâ€™audiciÃ³"
  ],
  correcta: "a"
},
{
  texto: "QuÃ¨ Ã©s lâ€™ecotoxicitat?",
  opciones: [
    "a) Impacte de substÃ ncies quÃ­miques sobre els ecosistemes",
    "b) ContaminaciÃ³ acÃºstica",
    "c) Efecte hivernacle",
    "d) Increment de la radiaciÃ³ solar"
  ],
  correcta: "a"
},
{
  texto: "Quins compostos contribueixen principalment a la toxicitat humana?",
  opciones: [
    "a) Metalls pesants i compostos orgÃ nics persistents (COP)",
    "b) Aigua destilÂ·lada i oxigen",
    "c) Gasos nobles i nitrogen",
    "d) Compostos aromÃ tics volÃ tils naturals"
  ],
  correcta: "a"
},
{
  texto: "Quin Ã©s el gas mÃ©s greu emÃ¨s pels abocadors?",
  opciones: [
    "a) MetÃ  (CHâ‚„)",
    "b) DiÃ²xid de carboni (COâ‚‚)",
    "c) OzÃ³ (Oâ‚ƒ)",
    "d) DiÃ²xid de sofre (SOâ‚‚)"
  ],
  correcta: "a"
},
{
  texto: "QuÃ¨ sÃ³n els lixiviats?",
  opciones: [
    "a) LÃ­quids que drenen dels abocadors i contaminen aigÃ¼es subterrÃ nies",
    "b) Gasos de combustiÃ³ industrial",
    "c) Compostos utilitzats per purificar lâ€™aigua",
    "d) PartÃ­cules sÃ²lides reciclades"
  ],
  correcta: "a"
},
{
  texto: "Quina Ã©s una de les causes de lâ€™esgotament dels recursos naturals?",
  opciones: [
    "a) Sobreconsum i Ãºs excessiu de recursos no renovables",
    "b) DisminuciÃ³ de la poblaciÃ³ mundial",
    "c) Augment de la biodiversitat",
    "d) CreaciÃ³ de reserves naturals"
  ],
  correcta: "a"
},
{
  texto: "Quina Ã©s una conseqÃ¼Ã¨ncia directa de la sobrepoblaciÃ³?",
  opciones: [
    "a) Augment de la demanda de recursos naturals",
    "b) DisminuciÃ³ del consum energÃ¨tic",
    "c) Millora de la qualitat de lâ€™aire",
    "d) ReducciÃ³ dels residus generats"
  ],
  correcta: "a"
},
{
  texto: "Quina dâ€™aquestes NO Ã©s una causa de lâ€™esgotament de recursos?",
  opciones: [
    "a) Sobreconsum",
    "b) Desenvolupament industrial",
    "c) DistribuciÃ³ equitativa de recursos",
    "d) SobrepoblaciÃ³"
  ],
  correcta: "c"
},
{
  texto: "Quin any es van proposar els Objectius de Desenvolupament Sostenible (ODS)?",
  opciones: [
    "a) 2010",
    "b) 2012",
    "c) 2015",
    "d) 2020"
  ],
  correcta: "c"
},
{
  texto: "Quin any es va publicar el 8Ã¨ Programa dâ€™AcciÃ³ Ambiental de la UniÃ³ Europea?",
  opciones: [
    "a) 2015",
    "b) 2020",
    "c) 2022",
    "d) 2024"
  ],
  correcta: "c"
},
{
  texto: "Quin Ã©s lâ€™objectiu climÃ tic de la UniÃ³ Europea per a lâ€™any 2030 segons el 8Ã¨ Programa dâ€™AcciÃ³ Ambiental?",
  opciones: [
    "a) Reduir les emissions un 25%",
    "b) Reduir les emissions un 55% respecte als nivells de 1990",
    "c) Reduir les emissions un 75%",
    "d) Neutralitat climÃ tica total"
  ],
  correcta: "b"
},
{
  texto: "Quin Ã©s lâ€™objectiu principal de la UniÃ³ Europea per a lâ€™any 2050 segons el 8Ã¨ Programa dâ€™AcciÃ³ Ambiental?",
  opciones: [
    "a) Aconseguir la neutralitat climÃ tica",
    "b) Reduir les emissions un 25%",
    "c) Eliminar tots els residus industrials",
    "d) Augmentar les emissions de COâ‚‚ per sobre del 1990"
  ],
  correcta: "a"
}
  
];
// --- FRASES DE ÃNIMO ---
const frases_animo = [
Â  "Â¡Muy bien! ğŸ˜",
Â  "Â¡Eso es, perfecto, te camelo caramelo! ğŸ”¥",
Â  "Â¡Ole tÃº huevos! ğŸ’ª",
Â  "Â¡Exacto, estÃ¡s on fire! ğŸš€",
Â  "Â¡QuÃ© mÃ¡quina eres! ğŸ˜",
Â  "Â¡Correcto, asÃ­ se hace! ğŸ‘",
Â  "Â¡Te lo sabes de memoria ya! ğŸ’¥"
];

// --- VARIABLES ---
let i = 0;
let puntuacion = 0;
let preguntasParaEsteTest = [];

// --- FUNCIONES ---

/**
 * Baraja un array aleatoriamente (algoritmo Fisher-Yates).
 * @param {Array} array El array a barajar.
 */
function barajarPreguntas(array) {
  let currentIndex = array.length,  randomIndex;

  while (currentIndex != 0) {
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;
    [array[currentIndex], array[randomIndex]] = [
      array[randomIndex], array[currentIndex]];
  }
  return array;
}

/**
 * Muestra un mensaje en el chat.
 * @param {string} texto El contenido del mensaje.
 * @param {string} tipo 'bot' o 'user'.
 */
function mostrarMensaje(texto, tipo) {
Â  const chat = document.getElementById("chat");
Â  const msg = document.createElement("div");
Â  msg.classList.add("message", tipo);
  // Convierte los saltos de lÃ­nea (\n) en etiquetas <br>
Â  msg.innerHTML = texto.replace(/\n/g, "<br>");
Â  chat.appendChild(msg);
Â  chat.scrollTop = chat.scrollHeight;
}

/**
 * Muestra la pregunta actual y sus opciones en un solo mensaje.
 */
function mostrarPregunta() {
  // Usa el array de 20 preguntas
Â  if (!preguntasParaEsteTest[i]) return;

Â  const p = preguntasParaEsteTest[i];
  // Une la pregunta y las opciones en un solo texto
Â  const textoCompleto = `${p.texto}\n\n${p.opciones.join("\n")}`;
Â  mostrarMensaje(textoCompleto, "bot");
}

/**
 * Procesa la respuesta del usuario.
 * @param {string} opcionElegida "a", "b", "c" o "d".
 */
function responder(opcionElegida) {
  // Usa el array de 20 preguntas
Â  if (!preguntasParaEsteTest[i]) return;

Â  const p = preguntasParaEsteTest[i];
  // Muestra solo la letra, como pediste
Â  mostrarMensaje(`${opcionElegida.toUpperCase()}`, "user");

Â  if (opcionElegida === p.correcta) {
Â  Â  puntuacion++;
Â  Â  mostrarMensaje(frases_animo[Math.floor(Math.random() * frases_animo.length)], "bot");
Â  } else {
Â  Â  mostrarMensaje(`âŒ Incorrecto. La respuesta correcta era ${p.correcta.toUpperCase()}.`, "bot");
Â  }

Â  i++;
  // Comprueba si quedan preguntas en el array de 20
Â  if (i < preguntasParaEsteTest.length) {
Â  Â  setTimeout(mostrarPregunta, 800);
Â  } else {
Â  Â  setTimeout(() => {
      // Muestra la puntuaciÃ³n final sobre 20 (o el total que haya)
Â  Â  Â  mostrarMensaje(`ğŸ Has acertado ${puntuacion} de ${preguntasParaEsteTest.length} preguntas. ğŸ’¡`, "bot");
Â  Â  Â  desactivarBotones();
Â  Â  }, 800);
Â  }
}

/**
 * Desactiva los botones de opciÃ³n al final del test.
 */
function desactivarBotones() {
Â  document.querySelectorAll(".btn-opcion").forEach(btn => btn.disabled = true);
}

// --- ARRANQUE ---
document.addEventListener("DOMContentLoaded", () => {
Â  i = 0;
Â  puntuacion = 0;
  
  // 1. Barajamos TODO el array de preguntas
  barajarPreguntas(preguntas); 
  
  // 2. Nos quedamos solo con las 20 primeras (o menos, si el array es mÃ¡s corto)
  preguntasParaEsteTest = preguntas.slice(0, 20); 

Â  mostrarMensaje(`ğŸ§  Bienvenido al test. Se han elegido ${preguntasParaEsteTest.length} preguntas al azar. ğŸ’¬`, "bot");
Â  setTimeout(mostrarPregunta, 500);

Â  document.getElementById("btnA").onclick = () => responder("a");
Â  document.getElementById("btnB").onclick = () => responder("b");
Â  document.getElementById("btnC").onclick = () => responder("c");
Â  document.getElementById("btnD").onclick = () => responder("d");
});


